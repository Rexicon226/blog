---
.title = "Fast inversion on Cyclotomic Groups",
.date = @date("2025-05-28T00:00:00"),
.author = "David Rubin",
.layout = "post.shtml",
.draft = true,
--- 


# Explaining Cyclotomic Groups

Background concepts we need to know:

- Field Extension
- Field Tower
- Cyclotomic Subgroup

## What is a Field Extension?

Let [`\mathbb{F}_p`](/$) denote the **prime field** of
characteristic [`p`](/$), with [`p`](/$) a prime number.
This field contains [`p`](/$) elements and is
the starting point for constructing larger fields.

A **field extension** [`\mathbb{F}_{p^n}`](/$) is a field
with [`p^n`](/$) elements, constructed as a degree-[`n`](/$)
extension of [`\mathbb{F}_p`](/$). Formally:

```=mathtex
\mathbb{F}_{p^n} \cong \mathbb{F}_p[x] \mathbin{/} (f(x))
```

where [`f(x)`](/$) is an irreducible polynomial of degree
[`n`](/$) over [`\mathbb{F}_p`](/$).

This means we construct the extension [`\mathbb{F}_{p^n}`](/$)
by taking polynomials over [`\mathbb{F}_p`](/$) and reducing
them modulo some irreducible polynomial of degree [`n`](/$).
Each element in [`\mathbb{F}_{p^n}`](/$) can be represented
as:

```=mathtex
a_0 + {a_1}x + {a_2}x^2 + ... + {a_{n-1}}x^{n - 1}, \; \text{with} \; a_i
\in \mathbb{F}_p
```

## Field Towers

Some algorithms work over field extensions. BLS-381 is a common
example of them at work, with the pairing using 
12-degree extensions of the field.

Instead of constructing [`\mathbb{F}_{p^{12}}`](/$) in one step,
it is common to build it using a **tower of extensions**,
like so:

```=mathtex
\mathbb{F}_p \subset \mathbb{F}_{p^2} \subset \mathbb{F}_{p^6} \subset \mathbb{F}_{p^{12}}
```

This layered approach enables more effienct arithmetic, since:
- Lower-degree extensions can often reuse optimized routines
- Multiplication and inversion can be decomposed recursively

Each step uses an irreducible polynomial over the previous field. For example:

- [`\mathbb{F}_{p^2} = \mathbb{F}_p[u]/(u^2 + 1)`](/$) (quadratic extension)
- [`\mathbb{F}_{p^6} = \mathbb{F}_{p^2}[v]/(v^3 - \xi)`](/$),
where [`\xi \in \mathbb{F}_{p^2}`](/$) is non-cube
- [`\mathbb{F}_{p^{12}} = \mathbb{F}_{p^6}[w]/(w^2 - \zeta)`](/$), where 
[`\zeta \in \mathbb{F}_{p^6}`](/$) is non-square

This technique is widely used in pairing-friendly curves, like BLS and BN families. 
Algorithms such as miller-loop for pairing checks use these higher-degree field extensions.

### Multiplicative Group Structure

We can now consider the **multiplicative group** [`\mathbb{F}_{p^{12}}^*`](/$), which is the set of
nonzero elements of the field under multiplication. Refer back
to the previous blogpost for a more elaborate explanation on the subject. 
This group is cyclic of order [`p^{12} - 1`](/$).

```=mathtex
\mathbb{F}_{p^{12}}^* \cong \langle G \rangle \; \text{for some}
\; g \in \mathbb{F}_{p^{12}}
```

Every non-zero element can be written as a power of a generator [`g`](/$). This group 
has many subgroups, and the **cyclotomic subgroup** is a particularally interesting one.

### Cyclotomic Subgroups

Given a finite field [`\mathbb{F}_{p^k}`](/$), let's define
the [`m`](/$)-th cyclotomic subgroup of [`\mathbb{F}_{p^k}^*`](/$) as the set of all elements 
whose order divides [`m`](/$):

```=mathtex
\mu_m(\mathbb{F}_{p^k}) := \{ x \in \mathbb{F}_{p^k}^* \mid x^m = 1 \}
```

These are the [`m`](/$)**-th roots of unity** in the field. If [`m \mid p^k - 1`](/$), 
then this set forms a **cyclic subgroup of order** [`m`](/$).

Applying this idea to pairings:

Suppose [`E / \mathbb{F}_p`](/$) is an elliptic curve and [`r`](/$) is a large prime
dividing the curve order. The **embedding degree** [`k`](/$) is the smallest integer
such that [`r \mid p^k - 1`](/$). This means that the curve's group of [`r`](/$)**-torsion**
points can be paired with a multiplicative subgroup [`\mathbb{F}_{p^k}^*`](/$) of order [`r`](/$).

So we often consider the [`r`](/$)**-torsion subgroup** of [`\mathbb{F}_{p^{12}}^*`](/$),
which lies in the [`r`](/$)**-th cyclotomic subgroup**:

```=mathtex
\mu_r(\mathbb{F}_{p^{12}}) := \{ x \in \mathbb{F}_{p^{12}}: \mid x^r = 1 \}
```

This subgroup lies inside of the **12-th cyclotomic subgroup** 
[`\mu_{p^{12} - 1}(\mathbb{F}_p^{12})`](/$), and the elements which are relevant
to cryptographic pairings often live in a particular **cyclotomic subgroup of order**
[`p^{12} - 1 \mathbin{/} r`](/$).
